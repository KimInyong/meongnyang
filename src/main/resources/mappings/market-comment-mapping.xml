<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="commentDAO">

	<select id="selectCountComment" parameterType="comment" resultType="int">
		SELECT COUNT(*)
		FROM market_comment
		WHERE market_tb_no = ${marketTbNo}
	</select>

	<select id="selectCommentList" parameterType="comment" resultType="comment">
		SELECT * FROM
		(SELECT 
		ROWNUM rnum,
		market_comment_tb_no,
		market_tb_no,
		market_comment_tb_content,
		market_comment_tb_reg_date,
		market_comment_tb_ref,
		market_comment_tb_step,
		market_comment_tb_depth,
		customer_tb_no
		FROM (SELECT * FROM market_comment 
		WHERE market_tb_no = ${marketTbNo} AND market_comment_tb_ref DESC AND market_comment_tb_step ASC))
		<![CDATA[WHERE rnum >= #{startRow} and rnum <= #{endRow}]]>
	</select>

	<insert id="insertComment" parameterType="comment">
		INSERT INTO market_comment
		(market_comment_tb_no,
		market_tb_no ,
		market_comment_tb_content ,
		market_comment_tb_reg_date ,
		market_comment_tb_ref ,
		market_comment_tb_step ,
		market_comment_tb_depth ,
		customer_tb_no)
		VALUES 
		(market_comment_seq.nextval,
		#{marketTbNo},
		#{marketCommentTbContent},
		#{marketCommentTbRef},
		#{marketCommentTbStep},
		#{marketCommentTbDepth},
		#{customerTbNo})
	</insert>

	<update id="updateComment" parameterType="comment">
		UPDATE market_comment
		SET
		market_comment_tb_content = #{marketCommentTbContent}
		WHERE
		market_comment_tb_no = #{marketCommentTbNo}
	</update>

	<delete id="deleteComment" parameterType="comment">
		DELETE FROM market_comment
		WHERE
		market_comment_tb_no = #{marketCommentTbNo}
	</delete>

</mapper>
